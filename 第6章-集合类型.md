# ç¬¬ 6 ç« ï¼šé›†åˆç±»å‹

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ Rust æ ‡å‡†åº“æä¾›çš„å¸¸ç”¨é›†åˆç±»å‹ã€‚ä¸æ•°ç»„å’Œå…ƒç»„ä¸åŒï¼Œè¿™äº›é›†åˆå°†æ•°æ®å­˜å‚¨åœ¨å †ä¸Šï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€å¢é•¿å’Œç¼©å°ã€‚æˆ‘ä»¬å°†å­¦ä¹ ä¸‰ç§ Rust ç¨‹åºä¸­æœ€å¸¸ç”¨çš„é›†åˆï¼šå‘é‡ï¼ˆVecï¼‰ã€å­—ç¬¦ä¸²ï¼ˆStringï¼‰å’Œå“ˆå¸Œæ˜ å°„ï¼ˆHashMapï¼‰ã€‚é€šè¿‡æŒæ¡è¿™äº›é›†åˆç±»å‹ï¼Œä½ å°†èƒ½å¤Ÿè§£å†³å„ç§æ•°æ®å­˜å‚¨å’Œå¤„ç†é—®é¢˜ã€‚

**å­¦ä¹ ç›®æ ‡ï¼š**

- æŒæ¡å‘é‡ï¼ˆVec<T>ï¼‰çš„åˆ›å»ºã€æ›´æ–°å’Œä½¿ç”¨æ–¹æ³•
- ç†è§£ Rust ä¸­å­—ç¬¦ä¸²ï¼ˆString å’Œ &strï¼‰çš„å·¥ä½œåŸç†
- å­¦ä¹ å“ˆå¸Œæ˜ å°„ï¼ˆHashMap<K, V>ï¼‰çš„åŸºæœ¬æ“ä½œ
- äº†è§£ä¸åŒé›†åˆç±»å‹çš„æ€§èƒ½ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯
- ç†Ÿç»ƒè¿ç”¨é›†åˆç±»å‹è§£å†³å®é™…ç¼–ç¨‹é—®é¢˜

## 6.1 å‘é‡ï¼ˆVec<T>ï¼‰

å‘é‡ï¼ˆVec<T>ï¼‰æ˜¯ Rust ä¸­æœ€å¸¸ç”¨çš„é›†åˆç±»å‹ä¹‹ä¸€ï¼Œå®ƒå…è®¸ä½ åœ¨å•ä¸ªæ•°æ®ç»“æ„ä¸­å­˜å‚¨å¤šä¸ªç›¸åŒç±»å‹çš„å€¼ï¼Œå¹¶åœ¨å†…å­˜ä¸­è¿ç»­å­˜æ”¾è¿™äº›å€¼ã€‚ä¸æ•°ç»„ä¸åŒï¼Œå‘é‡çš„å¤§å°å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€å¢é•¿å’Œç¼©å°ã€‚

### åˆ›å»ºå‘é‡

åˆ›å»ºå‘é‡æœ‰å¤šç§æ–¹å¼ï¼š

```rust
fn main() {
    // åˆ›å»ºç©ºå‘é‡
    let v1: Vec<i32> = Vec::new();

    // ä½¿ç”¨å®åˆ›å»ºå¸¦åˆå§‹å€¼çš„å‘é‡
    let v2 = vec![1, 2, 3];

    // åˆ›å»ºæŒ‡å®šå¤§å°çš„å‘é‡ï¼Œæ‰€æœ‰å…ƒç´ åˆå§‹åŒ–ä¸ºç›¸åŒå€¼
    let v3 = vec![0; 5]; // [0, 0, 0, 0, 0]

    println!("v2: {:?}", v2);
    println!("v3: {:?}", v3);
}
```

### æ›´æ–°å‘é‡

è¦å‘å‘é‡æ·»åŠ å…ƒç´ ï¼Œéœ€è¦å£°æ˜å®ƒä¸ºå¯å˜çš„ï¼š

```rust
fn main() {
    // åˆ›å»ºå¯å˜å‘é‡
    let mut v = Vec::new();

    // æ·»åŠ å…ƒç´ 
    v.push(5);
    v.push(6);
    v.push(7);
    v.push(8);

    println!("å‘é‡å†…å®¹: {:?}", v);

    // å¼¹å‡ºæœ€åä¸€ä¸ªå…ƒç´ 
    let last = v.pop(); // è¿”å› Option<T>
    println!("å¼¹å‡ºçš„å…ƒç´ : {:?}", last);
    println!("å¼¹å‡ºåçš„å‘é‡: {:?}", v);
}
```

### è¯»å–å‘é‡å…ƒç´ 

æœ‰ä¸¤ç§å¸¸è§çš„æ–¹å¼è®¿é—®å‘é‡ä¸­çš„å…ƒç´ ï¼š

1. ä½¿ç”¨ç´¢å¼•è¯­æ³•ï¼ˆå¯èƒ½å¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ï¼‰
2. ä½¿ç”¨ `get` æ–¹æ³•ï¼ˆè¿”å› `Option<&T>`ï¼‰

```rust
fn main() {
    let v = vec![10, 20, 30, 40, 50];

    // ä½¿ç”¨ç´¢å¼•è¯­æ³•ï¼ˆè¶Šç•Œä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼‰
    let third = &v[2];
    println!("ç¬¬ä¸‰ä¸ªå…ƒç´ : {}", third);

    // ä½¿ç”¨ get æ–¹æ³•å®‰å…¨è®¿é—®
    match v.get(2) {
        Some(value) => println!("ç¬¬ä¸‰ä¸ªå…ƒç´ å­˜åœ¨: {}", value),
        None => println!("ä¸å­˜åœ¨æ­¤ç´¢å¼•"),
    }

    // ç´¢å¼•è¶Šç•Œçš„ä¾‹å­
    // let non_existent = &v[100]; // è¿™ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ

    // ä½¿ç”¨ get æ–¹æ³•å¤„ç†è¶Šç•Œæƒ…å†µ
    let result = v.get(100);
    println!("ç´¢å¼•100çš„ç»“æœ: {:?}", result); // è¾“å‡º None
}
```

### æ‰€æœ‰æƒå’Œå€Ÿç”¨è§„åˆ™

å‘é‡ä¸å…¶ä»– Rust ç±»å‹ä¸€æ ·ï¼Œä¹Ÿéµå¾ªæ‰€æœ‰æƒè§„åˆ™ã€‚å½“æˆ‘ä»¬åœ¨æ‹¥æœ‰å‘é‡çš„å¯å˜å¼•ç”¨çš„åŒæ—¶ï¼Œä¸èƒ½è·å–å…¶å…ƒç´ çš„å¼•ç”¨ï¼š

```rust
fn main() {
    let mut v = vec![1, 2, 3, 4, 5];

    let first = &v[0]; // è·å–ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨

    // v.push(6); // é”™è¯¯ï¼ä¸èƒ½åŒæ—¶æ‹¥æœ‰å¯å˜å’Œä¸å¯å˜å¼•ç”¨

    println!("é¦–ä¸ªå…ƒç´ : {}", first); // é¦–ä¸ªå¼•ç”¨åœ¨è¿™é‡Œä½¿ç”¨

    // åœ¨ä¸å†ä½¿ç”¨ä¸å¯å˜å¼•ç”¨åï¼Œå¯ä»¥è·å–å¯å˜å¼•ç”¨
    v.push(6); // ç°åœ¨å¯ä»¥ä¿®æ”¹å‘é‡

    println!("å‘é‡: {:?}", v);
}
```

### éå†å‘é‡

å¯ä»¥ä½¿ç”¨å¤šç§æ–¹å¼éå†å‘é‡ä¸­çš„å…ƒç´ ï¼š

```rust
fn main() {
    let v = vec![100, 32, 57];

    // éå†ä¸å¯å˜å¼•ç”¨
    for element in &v {
        println!("å€¼: {}", element);
    }

    // éå†å¯å˜å¼•ç”¨å¹¶ä¿®æ”¹å…ƒç´ 
    let mut v2 = vec![10, 20, 30];
    for element in &mut v2 {
        *element += 50; // è§£å¼•ç”¨å¹¶ä¿®æ”¹å€¼
    }

    println!("ä¿®æ”¹å: {:?}", v2); // è¾“å‡º [60, 70, 80]
}
```

### ä½¿ç”¨æšä¸¾å­˜å‚¨å¤šç§ç±»å‹

å‘é‡åªèƒ½å­˜å‚¨ç›¸åŒç±»å‹çš„å…ƒç´ ï¼Œä½†å¯ä»¥ä½¿ç”¨æšä¸¾æ¥å­˜å‚¨ä¸åŒç±»å‹çš„å€¼ï¼š

```rust
#[derive(Debug)]
enum Cell {
    Integer(i32),
    Float(f64),
    Text(String),
}

fn main() {
    let row = vec![
        Cell::Integer(42),
        Cell::Text(String::from("æ–‡æœ¬")),
        Cell::Float(3.14),
    ];

    println!("æ··åˆç±»å‹å‘é‡: {:?}", row);

    // å¤„ç†ä¸åŒç±»å‹çš„å€¼
    for cell in &row {
        match cell {
            Cell::Integer(value) => println!("æ•´æ•°: {}", value),
            Cell::Float(value) => println!("æµ®ç‚¹æ•°: {}", value),
            Cell::Text(value) => println!("æ–‡æœ¬: {}", value),
        }
    }
}
```

### é«˜çº§å‘é‡æ“ä½œ

å‘é‡æä¾›äº†è®¸å¤šå®ç”¨çš„æ–¹æ³•ï¼š

```rust
fn main() {
    let mut v = vec![10, 20, 30, 40, 50];

    // æ’å…¥å…ƒç´ 
    v.insert(1, 15); // åœ¨ç´¢å¼•1å¤„æ’å…¥15
    println!("æ’å…¥å: {:?}", v);

    // åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ 
    v.remove(2); // åˆ é™¤ç´¢å¼•2å¤„çš„å…ƒç´ 
    println!("åˆ é™¤å: {:?}", v);

    // æ£€æŸ¥æ˜¯å¦åŒ…å«æŸä¸ªå€¼
    let contains30 = v.contains(&30);
    println!("åŒ…å«30? {}", contains30);

    // æ’åº
    let mut numbers = vec![3, 1, 4, 1, 5, 9];
    numbers.sort();
    println!("æ’åºå: {:?}", numbers);

    // åè½¬
    numbers.reverse();
    println!("åè½¬å: {:?}", numbers);

    // åˆ‡ç‰‡
    let slice = &numbers[1..4]; // è·å–éƒ¨åˆ†å‘é‡çš„åˆ‡ç‰‡
    println!("åˆ‡ç‰‡: {:?}", slice);

    // è¿æ¥å¤šä¸ªå‘é‡
    let v1 = vec![1, 2, 3];
    let v2 = vec![4, 5, 6];
    let mut v3 = v1.clone();
    v3.extend(v2);
    println!("è¿æ¥å: {:?}", v3);
}
```

### å‘é‡æ€§èƒ½è€ƒé‡

å‘é‡åœ¨å †ä¸Šåˆ†é…è¿ç»­å†…å­˜ï¼Œæä¾›ä»¥ä¸‹æ€§èƒ½ç‰¹æ€§ï¼š

- é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)
- åœ¨æœ«å°¾æ·»åŠ å…ƒç´ é€šå¸¸æ˜¯ O(1)ï¼Œä½†å½“éœ€è¦é‡æ–°åˆ†é…å†…å­˜æ—¶æ˜¯ O(n)
- åœ¨å¼€å¤´æˆ–ä¸­é—´æ’å…¥å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œå› ä¸ºéœ€è¦ç§»åŠ¨åç»­å…ƒç´ 
- åˆ é™¤å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ç±»ä¼¼äºæ’å…¥

å‘é‡ä¼šé¢„åˆ†é…é¢å¤–å®¹é‡ä»¥å‡å°‘é‡æ–°åˆ†é…çš„é¢‘ç‡ã€‚å¯ä»¥ä½¿ç”¨ `with_capacity` æ¥é¢„åˆ†é…å®¹é‡ï¼š

```rust
fn main() {
    // é¢„åˆ†é…èƒ½å®¹çº³1000ä¸ªå…ƒç´ çš„å‘é‡
    let mut v = Vec::with_capacity(1000);

    for i in 0..1000 {
        v.push(i);
        // ä¸ä¼šè¿›è¡Œé‡æ–°åˆ†é…ï¼Œå› ä¸ºå·²ç»é¢„ç•™äº†è¶³å¤Ÿç©ºé—´
    }

    println!("é•¿åº¦: {}, å®¹é‡: {}", v.len(), v.capacity());
}
```

### ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å‘é‡

å‘é‡é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š

- éœ€è¦å­˜å‚¨å¯å˜æ•°é‡çš„ç›¸åŒç±»å‹å€¼
- éœ€è¦æŒ‰æ’å…¥é¡ºåºå­˜å‚¨å…ƒç´ 
- éœ€è¦é¢‘ç¹é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ 
- ä¸»è¦åœ¨åˆ—è¡¨æœ«å°¾è¿›è¡Œæ·»åŠ å’Œåˆ é™¤æ“ä½œ
- éœ€è¦å¯¹æ•´ä¸ªé›†åˆè¿›è¡Œè¿­ä»£

## 6.2 å­—ç¬¦ä¸²ï¼ˆString ä¸ &strï¼‰

Rust çš„å­—ç¬¦ä¸²å¤„ç†æ¯”è®¸å¤šå…¶ä»–è¯­è¨€æ›´ä¸ºå¤æ‚ï¼Œä½†ä¹Ÿæ›´ä¸ºå¼ºå¤§å’Œå®‰å…¨ã€‚Rust æœ‰ä¸¤ç§ä¸»è¦çš„å­—ç¬¦ä¸²ç±»å‹ï¼š`String` å’Œ `&str`ã€‚

### String ä¸ &str çš„åŒºåˆ«

- **String**ï¼šä¸€ä¸ªå¯å¢é•¿ã€å¯å˜ã€æ‹¥æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²ï¼Œå­˜å‚¨åœ¨å †ä¸Š
- **&str**ï¼šå­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œå¯¹ UTF-8 ç¼–ç å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼Œå¯ä»¥æ˜¯å¯¹ `String` çš„å¼•ç”¨ï¼Œæˆ–è€…æ˜¯ç¡¬ç¼–ç åˆ°ç¨‹åºä¸­çš„å­—ç¬¦ä¸²å­—é¢é‡

```rust
fn main() {
    // å­—ç¬¦ä¸²å­—é¢é‡æ˜¯ &str ç±»å‹
    let string_literal = "ä½ å¥½ï¼Œä¸–ç•Œ"; // ç±»å‹ä¸º &str

    // åˆ›å»ºä¸€ä¸ªç©ºçš„ String
    let mut mutable_string = String::new();

    // ä»å­—ç¬¦ä¸²å­—é¢é‡åˆ›å»º String
    let string1 = String::from("ä½ å¥½");
    let string2 = "ä¸–ç•Œ".to_string();

    println!("å­—é¢é‡: {}", string_literal);
    println!("å­—ç¬¦ä¸²1: {}", string1);
    println!("å­—ç¬¦ä¸²2: {}", string2);
}
```

### æ›´æ–°å­—ç¬¦ä¸²

å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å‘ `String` æ·»åŠ å†…å®¹ï¼š

```rust
fn main() {
    let mut s = String::from("ä½ å¥½");

    // ä½¿ç”¨ push_str æ·»åŠ å­—ç¬¦ä¸²åˆ‡ç‰‡
    s.push_str("ï¼Œä¸–ç•Œ");

    // ä½¿ç”¨ push æ·»åŠ å•ä¸ªå­—ç¬¦
    s.push('ï¼');

    println!("æ›´æ–°åçš„å­—ç¬¦ä¸²: {}", s);

    // ä½¿ç”¨ + è¿ç®—ç¬¦è¿æ¥å­—ç¬¦ä¸²
    let s1 = String::from("Hello, ");
    let s2 = String::from("world!");
    let s3 = s1 + &s2; // æ³¨æ„ï¼šs1 çš„æ‰€æœ‰æƒè¢«ç§»åŠ¨ï¼Œä¸èƒ½å†ä½¿ç”¨

    println!("s3: {}", s3);
    // println!("s1: {}", s1); // é”™è¯¯ï¼šs1 çš„æ‰€æœ‰æƒå·²è½¬ç§»
    println!("s2: {}", s2); // æ­£ç¡®ï¼šs2 åªæ˜¯å€Ÿç”¨

    // ä½¿ç”¨ format! å®è¿æ¥å¤šä¸ªå­—ç¬¦ä¸²
    let s1 = String::from("é—®å€™ï¼š");
    let s2 = String::from("ä½ å¥½ï¼Œ");
    let s3 = String::from("ä¸–ç•Œï¼");
    let s = format!("{}{}{}", s1, s2, s3);

    println!("æ ¼å¼åŒ–å: {}", s);
    println!("åŸå­—ç¬¦ä¸²ä»ç„¶æœ‰æ•ˆ: {}, {}, {}", s1, s2, s3);
}
```

### å­—ç¬¦ä¸²ç´¢å¼•

Rust ä¸æ”¯æŒä½¿ç”¨ç´¢å¼•è¯­æ³• `s[0]` è®¿é—®å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ã€‚è¿™æ˜¯å› ä¸º `String` æ˜¯ UTF-8 ç¼–ç çš„ï¼Œæ¯ä¸ªå­—ç¬¦å¯èƒ½å ç”¨å¤šä¸ªå­—èŠ‚ï¼š

```rust
fn main() {
    let s = String::from("ä½ å¥½");

    // ä»¥ä¸‹ä»£ç æ— æ³•ç¼–è¯‘
    // let first_char = s[0]; // é”™è¯¯ï¼šRust ä¸å…è®¸å­—ç¬¦ä¸²ç´¢å¼•

    println!("å­—ç¬¦ä¸²é•¿åº¦(å­—èŠ‚æ•°): {}", s.len()); // è¾“å‡º 6ï¼Œå› ä¸ºæ¯ä¸ªä¸­æ–‡å­—ç¬¦å 3ä¸ªå­—èŠ‚

    // è®¿é—®å­—èŠ‚
    for b in s.bytes() {
        println!("{}", b);
    }

    // è®¿é—®å­—ç¬¦ï¼ˆUnicode æ ‡é‡å€¼ï¼‰
    for c in s.chars() {
        println!("{}", c);
    }
}
```

### å­—ç¬¦ä¸²åˆ‡ç‰‡

å¯ä»¥ä½¿ç”¨åˆ‡ç‰‡è¯­æ³•åˆ›å»ºå­—ç¬¦ä¸²çš„å¼•ç”¨ï¼Œä½†å¿…é¡»ç¡®ä¿åˆ‡ç‰‡è¾¹ç•Œåœ¨æœ‰æ•ˆçš„å­—ç¬¦è¾¹ç•Œä¸Šï¼š

```rust
fn main() {
    let s = String::from("Hello, world!");

    let hello = &s[0..5]; // ä»0åˆ°4çš„å­—èŠ‚
    let world = &s[7..12]; // ä»7åˆ°11çš„å­—èŠ‚

    println!("{}..{}", hello, world);

    // å¯¹ä¸­æ–‡ç­‰å¤šå­—èŠ‚å­—ç¬¦ä½¿ç”¨åˆ‡ç‰‡æ—¶è¦å°å¿ƒ
    let s2 = String::from("ä½ å¥½ä¸–ç•Œ");

    // æ¯ä¸ªä¸­æ–‡å­—ç¬¦å 3ä¸ªå­—èŠ‚
    let ni = &s2[0..3];
    let hao = &s2[3..6];

    println!("{} {}", ni, hao);

    // é”™è¯¯ï¼šåˆ‡ç‰‡è¾¹ç•Œä¸åœ¨å­—ç¬¦è¾¹ç•Œä¸Š
    // let error_slice = &s2[0..2]; // è¿™ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ
}
```

### å­—ç¬¦ä¸²çš„å†…éƒ¨è¡¨ç¤º

`String` å®é™…ä¸Šæ˜¯ `Vec<u8>` çš„å°è£…ï¼ŒåŒ…å« UTF-8 ç¼–ç çš„å­—èŠ‚åºåˆ—ï¼š

```rust
fn main() {
    // è‹±æ–‡å­—ç¬¦åœ¨ UTF-8 ä¸­å  1 ä¸ªå­—èŠ‚
    let en = String::from("Hello");
    println!("è‹±æ–‡å­—ç¬¦ä¸²é•¿åº¦(å­—èŠ‚): {}", en.len()); // 5
    println!("è‹±æ–‡å­—ç¬¦ä¸²ä¸­å­—ç¬¦æ•°: {}", en.chars().count()); // 5

    // ä¸­æ–‡å­—ç¬¦åœ¨ UTF-8 ä¸­å  3 ä¸ªå­—èŠ‚
    let zh = String::from("ä½ å¥½");
    println!("ä¸­æ–‡å­—ç¬¦ä¸²é•¿åº¦(å­—èŠ‚): {}", zh.len()); // 6
    println!("ä¸­æ–‡å­—ç¬¦ä¸²ä¸­å­—ç¬¦æ•°: {}", zh.chars().count()); // 2

    // è¡¨æƒ…ç¬¦å·å¯èƒ½å  4 ä¸ªå­—èŠ‚
    let emoji = String::from("ğŸ‘‹");
    println!("è¡¨æƒ…ç¬¦å·é•¿åº¦(å­—èŠ‚): {}", emoji.len()); // 4
    println!("è¡¨æƒ…ç¬¦å·ä¸­å­—ç¬¦æ•°: {}", emoji.chars().count()); // 1
}
```

### å¸¸ç”¨çš„å­—ç¬¦ä¸²æ“ä½œ

Rust æä¾›äº†å¤šç§å­—ç¬¦ä¸²æ“ä½œæ–¹æ³•ï¼š

```rust
fn main() {
    let mut s = String::from("Hello, Rust!");

    // æ£€æŸ¥æ˜¯å¦åŒ…å«å­ä¸²
    println!("åŒ…å« 'Rust' ? {}", s.contains("Rust"));

    // æ›¿æ¢
    let replaced = s.replace("Rust", "World");
    println!("æ›¿æ¢å: {}", replaced);

    // æ¸…ç©ºå­—ç¬¦ä¸²
    s.clear();
    println!("æ¸…ç©ºå: '{}', é•¿åº¦: {}", s, s.len());
}
```

### å­—ç¬¦ä¸²ä¸å…¶ä»–ç±»å‹çš„è½¬æ¢

å­—ç¬¦ä¸²ä¸å…¶ä»–ç±»å‹ä¹‹é—´çš„è½¬æ¢æ˜¯å¸¸è§æ“ä½œï¼š

```rust
fn main() {
    // æ•°å­—è½¬å­—ç¬¦ä¸²
    let integer = 42;
    let integer_string = integer.to_string();
    println!("æ•´æ•°åˆ°å­—ç¬¦ä¸²: {}", integer_string);

    let float = 3.14;
    let float_string = float.to_string();
    println!("æµ®ç‚¹æ•°åˆ°å­—ç¬¦ä¸²: {}", float_string);

    // å­—ç¬¦ä¸²è½¬æ•°å­—
    let number_string = "42";
    let parsed_integer = number_string.parse::<i32>();

    match parsed_integer {
        Ok(n) => println!("è§£ææˆåŠŸ: {}", n),
        Err(_) => println!("è§£æé”™è¯¯"),
    }

    // ä½¿ç”¨ unwrapï¼ˆåœ¨ç¡®å®šä¸ä¼šå¤±è´¥æ—¶ï¼‰
    let number: i32 = "42".parse().unwrap();
    println!("è§£æçš„æ•°å­—: {}", number);

    // å­—ç¬¦ä¸²ä¸è·¯å¾„
    use std::path::Path;
    let path_string = "/usr/local/bin";
    let path = Path::new(path_string);
    println!("è·¯å¾„: {:?}", path);
}
```

### å­—ç¬¦ä¸²æ€§èƒ½è€ƒé‡

- `String` åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œä¸ `Vec<u8>` ç±»ä¼¼
- å­—ç¬¦ä¸²è¿æ¥å¯èƒ½å¯¼è‡´å¤šæ¬¡å†…å­˜åˆ†é…ï¼Œä½¿ç”¨ `String::with_capacity` é¢„åˆ†é…ç©ºé—´å¯ä»¥æé«˜æ€§èƒ½
- å¯¹äºåªè¯»æ“ä½œï¼Œåº”å°½å¯èƒ½ä½¿ç”¨ `&str` è€Œé `String`
- éå†å­—ç¬¦ (`.chars()`) æ¯”éå†å­—èŠ‚ (`.bytes()`) æ…¢ï¼Œå› ä¸ºéœ€è¦è§£ç  UTF-8

```rust
fn main() {
    // é¢„åˆ†é…å®¹é‡
    let mut s = String::with_capacity(100);

    for i in 0..20 {
        s.push_str("æ·»åŠ ä¸€äº›æ–‡æœ¬");
    }

    println!("é•¿åº¦: {}, å®¹é‡: {}", s.len(), s.capacity());
}
```

### ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ String æˆ– &str

ä¸€èˆ¬å‡†åˆ™ï¼š

- **ä½¿ç”¨ &str**ï¼šä½œä¸ºå‡½æ•°å‚æ•°ï¼Œç”¨äºå­—ç¬¦ä¸²æŸ¥è¯¢ã€åªè¯»è®¿é—®
- **ä½¿ç”¨ String**ï¼šéœ€è¦æ‹¥æœ‰æˆ–ä¿®æ”¹å­—ç¬¦ä¸²å†…å®¹æ—¶

```rust
// æ¥å—å­—ç¬¦ä¸²åˆ‡ç‰‡ä½œä¸ºå‚æ•°ï¼ˆé«˜æ•ˆï¼Œä¸è·å–æ‰€æœ‰æƒï¼‰
fn print_message(message: &str) {
    println!("æ¶ˆæ¯: {}", message);
}

// è¿”å›æ‹¥æœ‰çš„å­—ç¬¦ä¸²
fn generate_message() -> String {
    String::from("è¿™æ˜¯ä¸€æ¡æ–°æ¶ˆæ¯")
}

fn main() {
    let s1 = "ä½ å¥½"; // &str
    let s2 = String::from("ä¸–ç•Œ"); // String

    // ä¸¤ç§ç±»å‹éƒ½å¯ä»¥ä¼ é€’ç»™æ¥å— &str çš„å‡½æ•°
    print_message(s1);
    print_message(&s2); // String å¯ä»¥è§£å¼•ç”¨è½¬æ¢ä¸º &str

    let s3 = generate_message();
    println!("{}", s3);
}
```

## 6.3 å“ˆå¸Œæ˜ å°„ï¼ˆHashMap<K, V>ï¼‰

å“ˆå¸Œæ˜ å°„ï¼ˆHashMap<K, V>ï¼‰å…è®¸ä½ å­˜å‚¨é”®å€¼å¯¹ï¼Œå¹¶é€šè¿‡é”®å¿«é€ŸæŸ¥æ‰¾å¯¹åº”çš„å€¼ã€‚ä¸åŒäºå‘é‡é€šè¿‡ç´¢å¼•è®¿é—®æ•°æ®ï¼Œå“ˆå¸Œæ˜ å°„é€šè¿‡ä»»æ„ç±»å‹çš„é”®ï¼ˆå¦‚å­—ç¬¦ä¸²ï¼‰å…³è”å’Œè®¿é—®æ•°æ®ã€‚

### åˆ›å»ºå“ˆå¸Œæ˜ å°„

åˆ›å»ºå“ˆå¸Œæ˜ å°„éœ€è¦æ˜¾å¼å¼•å…¥æ ‡å‡†åº“ï¼š

```rust
use std::collections::HashMap;

fn main() {
    // åˆ›å»ºç©ºå“ˆå¸Œæ˜ å°„
    let mut scores = HashMap::new();

    // æ’å…¥é”®å€¼å¯¹
    scores.insert(String::from("è“é˜Ÿ"), 10);
    scores.insert(String::from("çº¢é˜Ÿ"), 50);

    println!("åˆ†æ•°æ˜ å°„: {:?}", scores);

    // ä»ä¸¤ä¸ªå‘é‡åˆ›å»ºå“ˆå¸Œæ˜ å°„
    let teams = vec![String::from("è“é˜Ÿ"), String::from("é»„é˜Ÿ")];
    let initial_scores = vec![10, 50];

    // ä½¿ç”¨ zip å°†ä¸¤ä¸ªå‘é‡ç»„åˆä¸ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œcollect æ”¶é›†ä¸º HashMap
    let team_scores: HashMap<_, _> = teams.into_iter().zip(initial_scores.into_iter()).collect();

    println!("ä»å‘é‡åˆ›å»º: {:?}", team_scores);
}
```

### å“ˆå¸Œæ˜ å°„ä¸æ‰€æœ‰æƒ

å¯¹äºå®ç°äº† `Copy` ç‰¹æ€§çš„ç±»å‹ï¼ˆå¦‚ `i32`ï¼‰ï¼Œå€¼ä¼šè¢«å¤åˆ¶åˆ°å“ˆå¸Œæ˜ å°„ä¸­ã€‚å¯¹äºæ‹¥æœ‰æ‰€æœ‰æƒçš„å€¼ï¼ˆå¦‚ `String`ï¼‰ï¼Œå€¼çš„æ‰€æœ‰æƒä¼šè½¬ç§»åˆ°å“ˆå¸Œæ˜ å°„ä¸­ï¼š

```rust
use std::collections::HashMap;

fn main() {
    let field_name = String::from("é¢œè‰²");
    let field_value = String::from("è“è‰²");

    let mut map = HashMap::new();
    map.insert(field_name, field_value);

    // é”™è¯¯ï¼šå­—æ®µåå’Œå­—æ®µå€¼çš„æ‰€æœ‰æƒå·²è½¬ç§»åˆ°æ˜ å°„ä¸­
    // println!("å­—æ®µå: {}", field_name);

    // å¦‚æœä¸æƒ³è½¬ç§»æ‰€æœ‰æƒï¼Œå¯ä»¥æ’å…¥å¼•ç”¨
    let name = String::from("å°ºå¯¸");
    let value = String::from("å¤§");

    let mut reference_map = HashMap::new();
    reference_map.insert(&name, &value);

    // åç§°å’Œå€¼ä»ç„¶å¯ç”¨
    println!("åç§°: {}, å€¼: {}", name, value);
    println!("å¼•ç”¨æ˜ å°„: {:?}", reference_map);
}
```

### è®¿é—®å“ˆå¸Œæ˜ å°„ä¸­çš„å€¼

å¯ä»¥ä½¿ç”¨ `get` æ–¹æ³•ä»å“ˆå¸Œæ˜ å°„ä¸­æ£€ç´¢å€¼ï¼š

```rust
use std::collections::HashMap;

fn main() {
    let mut scores = HashMap::new();

    scores.insert(String::from("è“é˜Ÿ"), 10);
    scores.insert(String::from("çº¢é˜Ÿ"), 50);

    let team = String::from("è“é˜Ÿ");
    let blue_team_score = scores.get(&team);

    match blue_team_score {
        Some(score) => println!("è“é˜Ÿåˆ†æ•°: {}", score),
        None => println!("æ‰¾ä¸åˆ°è“é˜Ÿ"),
    }

    // æ›´ç®€æ´çš„å†™æ³•ï¼Œæä¾›é»˜è®¤å€¼
    let yellow_team_score = scores.get("é»„é˜Ÿ").unwrap_or(&0);
    println!("é»„é˜Ÿåˆ†æ•°: {}", yellow_team_score);

    // éå†å“ˆå¸Œæ˜ å°„
    for (key, value) in &scores {
        println!("{}: {}", key, value);
    }
}
```

### æ›´æ–°å“ˆå¸Œæ˜ å°„

æœ‰å¤šç§æ–¹å¼å¯ä»¥æ›´æ–°å“ˆå¸Œæ˜ å°„ä¸­çš„å€¼ï¼š

```rust
use std::collections::HashMap;

fn main() {
    let mut scores = HashMap::new();

    // è¦†ç›–ç°æœ‰å€¼
    scores.insert(String::from("è“é˜Ÿ"), 10);
    println!("åˆå§‹åˆ†æ•°: {:?}", scores);

    scores.insert(String::from("è“é˜Ÿ"), 25); // è¦†ç›–è“é˜Ÿçš„åˆ†æ•°
    println!("æ›´æ–°ååˆ†æ•°: {:?}", scores);

    // åªåœ¨é”®ä¸å­˜åœ¨æ—¶æ’å…¥
    scores.entry(String::from("é»„é˜Ÿ")).or_insert(50);
    scores.entry(String::from("è“é˜Ÿ")).or_insert(50); // è“é˜Ÿå·²å­˜åœ¨ï¼Œä¸ä¼šä¿®æ”¹

    println!("æ·»åŠ é»„é˜Ÿå: {:?}", scores);

    // åŸºäºæ—§å€¼æ›´æ–°å€¼
    let text = "ä½ å¥½ä¸–ç•Œä½ å¥½";
    let mut char_count = HashMap::new();

    for word in text.split_whitespace() {
        let count = char_count.entry(word).or_insert(0);
        *count += 1; // è§£å¼•ç”¨å¹¶ä¿®æ”¹å€¼
    }

    println!("å­—ç¬¦æ•°ç»Ÿè®¡: {:?}", char_count);

    // åˆ é™¤é”®å€¼å¯¹
    scores.remove(&String::from("è“é˜Ÿ"));
    println!("ç§»é™¤è“é˜Ÿå: {:?}", scores);
}
```

### é«˜çº§å“ˆå¸Œæ˜ å°„æ“ä½œ

å“ˆå¸Œæ˜ å°„æä¾›äº†è®¸å¤šå®ç”¨çš„æ–¹æ³•ï¼š

```rust
use std::collections::HashMap;

fn main() {
    let mut map = HashMap::new();
    map.insert("one", 1);
    map.insert("two", 2);
    map.insert("three", 3);

    // æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨
    println!("åŒ…å«'one'? {}", map.contains_key("one"));

    // è·å–æ˜ å°„ä¸­çš„é”®å€¼å¯¹æ•°é‡
    println!("æ˜ å°„å¤§å°: {}", map.len());

    // æ£€æŸ¥æ˜ å°„æ˜¯å¦ä¸ºç©º
    println!("æ˜ å°„æ˜¯å¦ä¸ºç©º? {}", map.is_empty());

    // æ¸…ç©ºæ˜ å°„
    map.clear();
    println!("æ¸…ç©ºåå¤§å°: {}", map.len());

    // åˆå¹¶ä¸¤ä¸ªæ˜ å°„
    let mut map1 = HashMap::new();
    map1.insert(1, "a");
    map1.insert(2, "b");

    let mut map2 = HashMap::new();
    map2.insert(3, "c");
    map2.insert(4, "d");

    // å°†map2çš„æ‰€æœ‰é”®å€¼å¯¹ç§»åŠ¨åˆ°map1
    map1.extend(map2);
    println!("åˆå¹¶å: {:?}", map1);
}
```

### è‡ªå®šä¹‰ç±»å‹ä½œä¸ºé”®

è¦ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹ä½œä¸ºå“ˆå¸Œæ˜ å°„çš„é”®ï¼Œè¯¥ç±»å‹éœ€è¦å®ç° `Eq` å’Œ `Hash` ç‰¹æ€§ï¼š

```rust
use std::collections::HashMap;

#[derive(Hash, Eq, PartialEq, Debug)]
struct Student {
    id: u32,
    name: String,
}

fn main() {
    let mut grade_book = HashMap::new();

    let student1 = Student {
        id: 1001,
        name: String::from("å¼ ä¸‰"),
    };

    let student2 = Student {
        id: 1002,
        name: String::from("æå››"),
    };

    grade_book.insert(student1, 95);
    grade_book.insert(student2, 88);

    println!("æˆç»©å•: {:#?}", grade_book);

    // æŸ¥æ‰¾ç‰¹å®šå­¦ç”Ÿçš„æˆç»©
    let lookup = Student {
        id: 1001,
        name: String::from("å¼ ä¸‰"),
    };

    match grade_book.get(&lookup) {
        Some(score) => println!("å¼ ä¸‰çš„åˆ†æ•°: {}", score),
        None => println!("æ‰¾ä¸åˆ°è¯¥å­¦ç”Ÿ"),
    }
}
```

### å“ˆå¸Œå‡½æ•°

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`HashMap` ä½¿ç”¨ SipHash å“ˆå¸Œå‡½æ•°ï¼Œå®ƒæä¾›å¯¹å“ˆå¸Œç¢°æ’æ”»å‡»çš„é˜²æŠ¤ï¼Œä½†ä¸æ˜¯æœ€å¿«çš„å“ˆå¸Œç®—æ³•ã€‚å¦‚æœæ€§èƒ½æ˜¯å…³é”®è€ƒè™‘å› ç´ ï¼Œä¸”ä¸éœ€è¦æŠµæŠ—å“ˆå¸Œç¢°æ’æ”»å‡»ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–å“ˆå¸Œç®—æ³•ï¼š

```rust
use std::collections::HashMap;
use std::hash::{BuildHasher, Hasher};
use std::collections::hash_map::DefaultHasher;

fn calculate_hash<T: std::hash::Hash>(t: &T) -> u64 {
    let mut s = DefaultHasher::new();
    t.hash(&mut s);
    s.finish()
}

fn main() {
    let key1 = "hello";
    let key2 = "world";

    println!("'{}' çš„å“ˆå¸Œå€¼: {:x}", key1, calculate_hash(&key1));
    println!("'{}' çš„å“ˆå¸Œå€¼: {:x}", key2, calculate_hash(&key2));

    // æ ‡å‡†åº“ä¸­è¿˜æœ‰å…¶ä»–å“ˆå¸Œå™¨å¯ç”¨
    // å¦‚éœ€æ›´å¿«çš„å“ˆå¸Œå‡½æ•°ï¼Œå¯ä½¿ç”¨ ahash, fnv ç­‰ç¬¬ä¸‰æ–¹ crate
}
```

### å“ˆå¸Œæ˜ å°„æ€§èƒ½è€ƒé‡

`HashMap` æä¾›å¹³å‡ O(1) æ—¶é—´å¤æ‚åº¦çš„æŸ¥æ‰¾æ€§èƒ½ï¼Œä½†æœ‰ä¸€äº›æ€§èƒ½è€ƒé‡ï¼š

- å“ˆå¸Œè®¡ç®—æœ‰ä¸€å®šå¼€é”€
- å“ˆå¸Œå†²çªä¼šé™ä½æ€§èƒ½
- å¯ä»¥ä½¿ç”¨ `with_capacity` é¢„åˆ†é…ç©ºé—´ï¼Œå‡å°‘é‡æ–°å“ˆå¸Œçš„æ¬¡æ•°
- å¯¹äºå°å‹æ˜ å°„ï¼Œæœ‰æ—¶ä½¿ç”¨ `Vec<(K, V)>` å¹¶çº¿æ€§æœç´¢å¯èƒ½æ›´å¿«

```rust
use std::collections::HashMap;

fn main() {
    // é¢„åˆ†é…å®¹é‡
    let mut map = HashMap::with_capacity(100);

    for i in 0..100 {
        map.insert(i, i * 10);
    }

    println!("æ˜ å°„å¤§å°: {}, å®¹é‡: {}", map.len(), map.capacity());
}
```

### ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å“ˆå¸Œæ˜ å°„

å“ˆå¸Œæ˜ å°„é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š

- éœ€è¦é€šè¿‡ä»»æ„ç±»å‹çš„é”®ï¼ˆè€Œéç´¢å¼•ï¼‰æŸ¥æ‰¾å€¼
- éœ€è¦ç¡®ä¿é”®çš„å”¯ä¸€æ€§
- éœ€è¦å¿«é€ŸæŸ¥æ‰¾æ€§èƒ½
- ä¸å…³å¿ƒé”®çš„é¡ºåº

## 6.4 æ€§èƒ½è€ƒé‡ä¸ä½¿ç”¨åœºæ™¯

å½“é€‰æ‹©é›†åˆç±»å‹æ—¶ï¼Œäº†è§£æ€§èƒ½ç‰¹ç‚¹æœ‰åŠ©äºåšå‡ºæœ€ä½³é€‰æ‹©ï¼š

### ç±»å‹æ¯”è¾ƒ

| ç‰¹æ€§       | Vec<T>       | String            | HashMap<K, V>  |
| ---------- | ------------ | ----------------- | -------------- |
| å†…å­˜å¸ƒå±€   | è¿ç»­         | è¿ç»­ (UTF-8 å­—èŠ‚) | åˆ†æ•£ï¼Œå¸¦å“ˆå¸Œæ¡¶ |
| ç´¢å¼•è®¿é—®   | O(1)         | ä¸æ”¯æŒç›´æ¥ç´¢å¼•    | ä¸é€‚ç”¨         |
| æŸ¥æ‰¾å…ƒç´    | O(n)         | O(n)              | å¹³å‡ O(1)      |
| åœ¨æœ«å°¾æ·»åŠ  | å¹³å‡ O(1)    | å¹³å‡ O(1)         | ä¸é€‚ç”¨         |
| åœ¨ä¸­é—´æ’å…¥ | O(n)         | O(n)              | ä¸é€‚ç”¨         |
| æŒ‰é”®æŸ¥æ‰¾   | ä¸é€‚ç”¨       | ä¸é€‚ç”¨            | å¹³å‡ O(1)      |
| æœ‰åºæ€§     | ä¿æŒæ’å…¥é¡ºåº | ä¿æŒæ’å…¥é¡ºåº      | æ— åº           |

### é€‰æ‹©åˆé€‚çš„é›†åˆç±»å‹

- **ä½¿ç”¨ Vec<T>** å½“ä½ éœ€è¦ï¼š

  - æŒ‰ç´¢å¼•è®¿é—®å…ƒç´ 
  - æŒ‰æ’å…¥é¡ºåºå­˜å‚¨å…ƒç´ 
  - åªåœ¨æœ«å°¾æ·»åŠ å’Œåˆ é™¤å…ƒç´ 
  - éœ€è¦é¢‘ç¹è¿­ä»£æ•´ä¸ªé›†åˆ

- **ä½¿ç”¨ String** å½“ä½ éœ€è¦ï¼š

  - å¤„ç†æ–‡æœ¬
  - åŠ¨æ€æ„å»ºæˆ–ä¿®æ”¹æ–‡æœ¬
  - UTF-8 ç¼–ç æ”¯æŒ

- **ä½¿ç”¨ HashMap<K, V>** å½“ä½ éœ€è¦ï¼š
  - é€šè¿‡æŸç§é”®ï¼ˆéæ•´æ•°ç´¢å¼•ï¼‰æŸ¥æ‰¾å€¼
  - ç¡®ä¿é”®çš„å”¯ä¸€æ€§
  - å¿«é€ŸæŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤
  - ä¸å…³å¿ƒå…ƒç´ é¡ºåº

### åµŒå¥—é›†åˆç±»å‹

å¤æ‚æ•°æ®ç»“æ„é€šå¸¸æ¶‰åŠé›†åˆç±»å‹çš„åµŒå¥—ï¼š

```rust
use std::collections::HashMap;

fn main() {
    // å‘é‡ä¸­å­˜å‚¨å‘é‡
    let matrix: Vec<Vec<i32>> = vec![
        vec![1, 2, 3],
        vec![4, 5, 6],
        vec![7, 8, 9],
    ];

    println!("çŸ©é˜µç¬¬äºŒè¡Œç¬¬ä¸‰åˆ—: {}", matrix[1][2]);

    // å“ˆå¸Œæ˜ å°„ä¸­å­˜å‚¨å‘é‡
    let mut city_data = HashMap::new();

    city_data.insert(
        String::from("åŒ—äº¬"),
        vec![20, 22, 21, 23, 24], // ä¸€å‘¨æ¸©åº¦
    );

    city_data.insert(
        String::from("ä¸Šæµ·"),
        vec![25, 26, 27, 25, 24],
    );

    // å‘é‡ä¸­å­˜å‚¨å“ˆå¸Œæ˜ å°„
    let mut user_list = Vec::new();

    let mut user1 = HashMap::new();
    user1.insert("å§“å", "å¼ ä¸‰");
    user1.insert("å¹´é¾„", "25");

    let mut user2 = HashMap::new();
    user2.insert("å§“å", "æå››");
    user2.insert("å¹´é¾„", "28");

    user_list.push(user1);
    user_list.push(user2);

    for user in &user_list {
        println!("ç”¨æˆ·ä¿¡æ¯: {:?}", user);
    }
}
```

## 6.5 é›†åˆç±»å‹å®è·µ

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…ä¾‹å­ï¼Œæ¼”ç¤ºå¦‚ä½•ç»¼åˆä½¿ç”¨é›†åˆç±»å‹è§£å†³é—®é¢˜ã€‚

### æ–‡æœ¬åˆ†æå·¥å…·

è¿™ä¸ªä¾‹å­å°†åˆ›å»ºä¸€ä¸ªç®€å•çš„æ–‡æœ¬åˆ†æå·¥å…·ï¼Œç»Ÿè®¡å•è¯é¢‘ç‡ã€å­—ç¬¦é¢‘ç‡ï¼Œå¹¶åˆ†æå¥å­ç»“æ„ï¼š

```rust
use std::collections::HashMap;

fn analyze_text(text: &str) -> (HashMap<String, usize>, HashMap<char, usize>, usize) {
    let mut word_frequency: HashMap<String, usize> = HashMap::new();
    let mut char_frequency: HashMap<char, usize> = HashMap::new();
    let mut sentence_count = 0;

    // ç»Ÿè®¡å•è¯é¢‘ç‡
    for word in text.split_whitespace() {
        // å»é™¤æ ‡ç‚¹ç¬¦å·ï¼Œè½¬ä¸ºå°å†™
        let normalized = word.to_lowercase()
            .chars()
            .filter(|c| c.is_alphanumeric() || *c == '\'')
            .collect::<String>();

        if !normalized.is_empty() {
            let count = word_frequency.entry(normalized).or_insert(0);
            *count += 1;
        }
    }

    // ç»Ÿè®¡å­—ç¬¦é¢‘ç‡
    for char in text.chars() {
        if !char.is_whitespace() {
            let count = char_frequency.entry(char).or_insert(0);
            *count += 1;
        }
    }

    // ç»Ÿè®¡å¥å­
    let period_set = ['.', '!', '?', ';'];
    for char in text.chars() {
        if period_set.contains(&char) {
            sentence_count += 1;
        }
    }

    (word_frequency, char_frequency, sentence_count)
}

fn print_top_n_stats<T: std::fmt::Debug>(stats: &HashMap<T, usize>, title: &str, n: usize)
where T: Ord + Clone
{
    println!("\n{}", title);
    println!("{:-<40}", "");

    // å°†HashMapè½¬æ¢ä¸ºVecä»¥ä¾¿æ’åº
    let mut frequency_list: Vec<(T, usize)> = stats.iter()
        .map(|(k, v)| (k.clone(), *v))
        .collect();

    // æŒ‰é¢‘ç‡æ’åºï¼ˆä»é«˜åˆ°ä½ï¼‰
    frequency_list.sort_by(|a, b| b.1.cmp(&a.1));

    // æ‰“å°å‰Nä¸ª
    for (i, (item, frequency)) in frequency_list.iter().take(n).enumerate() {
        println!("{}. {:?}: {}", i + 1, item, frequency);
    }
}

fn main() {
    let sample_text = "
    Rustæ˜¯ä¸€é—¨ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ï¼Œä¸“æ³¨äºå®‰å…¨æ€§å’Œæ€§èƒ½ã€‚Rustéå¸¸å¿«é€Ÿä¸”å†…å­˜é«˜æ•ˆï¼šæ²¡æœ‰è¿è¡Œæ—¶æˆ–åƒåœ¾å›æ”¶å™¨ï¼Œ
    å®ƒèƒ½å¤Ÿä¸ºæ€§èƒ½å…³é”®å‹æœåŠ¡æä¾›æ”¯æŒï¼Œåœ¨åµŒå…¥å¼è®¾å¤‡ä¸Šè¿è¡Œï¼Œå¹¶ä¸”èƒ½å¤Ÿè½»æ¾ä¸å…¶ä»–è¯­è¨€é›†æˆã€‚
    Rustçš„ä¸°å¯Œç±»å‹ç³»ç»Ÿå’Œæ‰€æœ‰æƒæ¨¡å‹ä¿è¯äº†å†…å­˜å®‰å…¨å’Œçº¿ç¨‹å®‰å…¨ï¼Œè®©æ‚¨åœ¨ç¼–è¯‘æ—¶å°±èƒ½å¤Ÿæ¶ˆé™¤å„ç§å„æ ·çš„é”™è¯¯ã€‚
    ";

    let (word_frequency, char_frequency, sentence_count) = analyze_text(sample_text);

    println!("æ–‡æœ¬ç»Ÿè®¡");
    println!("==========");
    println!("æ€»å•è¯æ•°: {}", word_frequency.values().sum::<usize>());
    println!("ä¸åŒå•è¯æ•°: {}", word_frequency.len());
    println!("æ€»å­—ç¬¦æ•°: {}", char_frequency.values().sum::<usize>());
    println!("å¥å­æ•°: {}", sentence_count);

    // æ‰“å°æœ€å¸¸è§çš„å•è¯å’Œå­—ç¬¦
    print_top_n_stats(&word_frequency, "æœ€å¸¸è§çš„å•è¯", 5);
    print_top_n_stats(&char_frequency, "æœ€å¸¸è§çš„å­—ç¬¦", 5);
}
```

## ç»ƒä¹ ä¸å®è·µ

å®Œæˆä»¥ä¸‹ç»ƒä¹ ï¼Œå·©å›ºæœ¬ç« æ‰€å­¦æ¦‚å¿µï¼š

### ç»ƒä¹  6.1: å‘˜å·¥ç›®å½•ç³»ç»Ÿ

**ç›®æ ‡ï¼š** åˆ›å»ºä¸€ä¸ªç®€å•çš„å‘˜å·¥ç›®å½•ç³»ç»Ÿï¼Œæ”¯æŒæ·»åŠ å‘˜å·¥ã€æŒ‰éƒ¨é—¨ç»„ç»‡å’ŒæŸ¥è¯¢ã€‚

**è¦æ±‚ï¼š**

1. å®šä¹‰å‘˜å·¥ç»“æ„ä½“ï¼ŒåŒ…å«å§“åã€å·¥å·å’Œéƒ¨é—¨ç­‰å­—æ®µ
2. ä½¿ç”¨ `HashMap` å­˜å‚¨éƒ¨é—¨å’Œå‘˜å·¥åˆ—è¡¨çš„æ˜ å°„ï¼ˆéƒ¨é—¨ -> å‘˜å·¥å‘é‡ï¼‰
3. å®ç°æ·»åŠ å‘˜å·¥ã€è·å–éƒ¨é—¨å‘˜å·¥åˆ—è¡¨ã€æŸ¥æ‰¾å‘˜å·¥çš„åŠŸèƒ½
4. ä½¿ç”¨ `String` å¤„ç†å‘˜å·¥å§“åå’Œéƒ¨é—¨å

**æç¤ºï¼š** è€ƒè™‘å¦‚ä½•é«˜æ•ˆåœ°åŒæ—¶æŒ‰éƒ¨é—¨å’Œå·¥å·æŸ¥æ‰¾å‘˜å·¥ã€‚

### ç»ƒä¹  6.2: æ–‡æœ¬å¤„ç†å·¥å…·

**ç›®æ ‡ï¼š** åˆ›å»ºä¸€ä¸ªæ–‡æœ¬å¤„ç†å·¥å…·ï¼Œæ”¯æŒå­—æ•°ç»Ÿè®¡ã€è¡Œæ•°ç»Ÿè®¡å’Œç‰¹å®šå•è¯æŸ¥æ‰¾ã€‚

**è¦æ±‚ï¼š**

1. è¯»å–æ–‡æœ¬å†…å®¹åˆ° `String`
2. ä½¿ç”¨ `Vec` å­˜å‚¨æ–‡æœ¬çš„è¡Œ
3. ä½¿ç”¨ `HashMap` ç»Ÿè®¡å•è¯é¢‘ç‡
4. å®ç°æŒ‰é¢‘ç‡æ’åºè¾“å‡ºå¸¸è§å•è¯
5. æ”¯æŒæŸ¥æ‰¾åŒ…å«ç‰¹å®šå•è¯çš„æ‰€æœ‰è¡Œ

**æç¤ºï¼š** åˆç†ä½¿ç”¨ `String` çš„æ–¹æ³•å¦‚ `split`ã€`lines` å’Œ `contains`ã€‚

## å°ç»“

æœ¬ç« ä»‹ç»äº† Rust çš„ä¸‰ç§æ ¸å¿ƒé›†åˆç±»å‹ã€‚é€šè¿‡å­¦ä¹ è¿™äº›å†…å®¹ï¼Œä½ ç°åœ¨åº”è¯¥èƒ½å¤Ÿï¼š

- ä½¿ç”¨å‘é‡ï¼ˆVec<T>ï¼‰å­˜å‚¨å’Œæ“ä½œå¯å˜é•¿åº¦çš„åŒç±»å‹å…ƒç´ åºåˆ—
- ç†è§£ Rust ä¸­çš„å­—ç¬¦ä¸²ï¼ˆString å’Œ &strï¼‰å¹¶è¿›è¡Œæ–‡æœ¬å¤„ç†
- ä½¿ç”¨å“ˆå¸Œæ˜ å°„ï¼ˆHashMap<K, V>ï¼‰åˆ›å»ºé”®å€¼å…³è”å¹¶è¿›è¡Œé«˜æ•ˆæŸ¥æ‰¾
- æ ¹æ®ä¸åŒåœºæ™¯é€‰æ‹©åˆé€‚çš„é›†åˆç±»å‹
- ç»¼åˆåº”ç”¨å„ç§é›†åˆç±»å‹è§£å†³å®é™…é—®é¢˜

è¿™äº›é›†åˆç±»å‹æ˜¯ Rust æ ‡å‡†åº“çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå‡ ä¹åœ¨æ¯ä¸ª Rust ç¨‹åºä¸­éƒ½ä¼šç”¨åˆ°ã€‚ç†Ÿç»ƒæŒæ¡è¿™äº›ç±»å‹å°†å¤§å¤§æé«˜ä½ çš„ Rust ç¼–ç¨‹èƒ½åŠ›ã€‚

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹  Rust çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œè¿™æ˜¯ç¼–å†™å¥å£®ç¨‹åºçš„å…³é”®éƒ¨åˆ†ã€‚

## æ‰©å±•é˜…è¯»

æƒ³è¦æ·±å…¥äº†è§£æœ¬ç« å†…å®¹ï¼Œæ¨èä»¥ä¸‹èµ„æºï¼š

1. [Rust å®˜æ–¹æ–‡æ¡£ - å¸¸è§é›†åˆ](https://doc.rust-lang.org/book/ch08-00-common-collections.html) - æ›´è¯¦ç»†çš„é›†åˆç±»å‹è¯´æ˜
2. [Rust æ ‡å‡†åº“æ–‡æ¡£ - Vec](https://doc.rust-lang.org/std/vec/struct.Vec.html) - å‘é‡çš„å®Œæ•´ API æ–‡æ¡£
3. [Rust æ ‡å‡†åº“æ–‡æ¡£ - String](https://doc.rust-lang.org/std/string/struct.String.html) - å­—ç¬¦ä¸²çš„å®Œæ•´ API æ–‡æ¡£
4. [Rust æ ‡å‡†åº“æ–‡æ¡£ - HashMap](https://doc.rust-lang.org/std/collections/struct.HashMap.html) - å“ˆå¸Œæ˜ å°„çš„å®Œæ•´ API æ–‡æ¡£
